# -*- coding: utf-8 -*-
"""data.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1n2PIVP_9FYy137EVBsWXWlG0AetAFnMJ
"""

def get_data():
  PATH1 = '/content/drive/My Drive/COMP3710/PatternFlow/recognition/46105024/data/musae_facebook_target.csv'
  PATH2 = '/content/drive/My Drive/COMP3710/PatternFlow/recognition/46105024/data/musae_facebook_edges.csv'
  PATH3 = '/content/drive/My Drive/COMP3710/PatternFlow/recognition/46105024/data/musae_facebook_features.json'
  PATH4 = '/content/drive/My Drive/COMP3710/PatternFlow/recognition/46105024/data/facebook.npz'

  import numpy as np
  facebook_npz = np.load(PATH4)

  import torch
  from torch_geometric.data import Data,Dataset
  from torch_geometric.transforms import RandomLinkSplit, RandomNodeSplit

  edges = torch.from_numpy(facebook_npz['edges'].T)
  edges = edges.long()
  features = torch.from_numpy(facebook_npz['features'])
  target = torch.from_numpy(facebook_npz['target'])

  data = Data(x=features, y=target, edge_index=edges)
  RNS = RandomNodeSplit(split='train_rest', num_val = 0.1, num_test = 0.1)
  splits = RNS(data)
  train_mask, val_mask, test_mask = splits.train_mask, splits.val_mask, splits.test_mask
  return train_mask, val_mask, test_mask, data



